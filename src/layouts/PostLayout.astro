---
import Layout from "../layouts/Layout.astro";
import LogoShort from "../assets/logo/short.png";
import "../styles/post.css";

function dateObjToFullDate(date: Date) {
    const months = [
        "Janurary",
        "Feburary",
        "March",
        "April",
        "May",
        "June",
        "July",
        "August",
        "September",
        "October",
        "November",
        "December",
    ];
    const month = months[date.getMonth()];
    const day = date.getDay();
    const year = date.getFullYear();
    return `${month} ${day}, ${year}`;
}

interface PostProps {
    title: string;
    pubDate: Date;
    description: string;
    authors: string[];
    tags: string[];
}

const props = Astro.props.content;
const usableProps: PostProps = {
    title: props.title || "Untitled Article",
    pubDate: !isNaN(Date.parse(props.pubDate))
        ? new Date(props.pubDate)
        : new Date(0),
    description: props.description || "No description.",
    authors: Array.isArray(props.authors) ? props.authors : [],
    tags: Array.isArray(props.tags) ? props.tags : [],
};
---

<Layout>
    <div
        class="p-[1rem] max-w-[50vw] bg-background-2 border-[.2rem] border-foreground-2 rounded-[1rem] w-full top-[20vh] left-[50%] translate-x-[-50%] absolute"
    >
        <article class="relative">
            <header class="flex flex-col mb-[2rem] mx-auto max-w-[50%]">
                <dl>
                    <dt
                        class="flex flex-col items-center mb-[1rem] text-center"
                    >
                        <h1 id="title">{usableProps.title}</h1>
                        <img src={LogoShort.src} alt="TLL" width={300} />
                    </dt>
                    <dd>
                        <span id="description">{usableProps.description}</span>

                        <ul
                            id="tags"
                            class="flex flex-wrap gap-[.5rem] my-[.5rem]"
                        >
                            {
                                usableProps.tags.length !== 0 &&
                                    usableProps.tags.map((tag: string) => (
                                        <div
                                            id={`tag-${tag}`}
                                            class="py-[.25rem] px-[1rem] bg-background-1 border-[.2rem] border-foreground-secondary rounded-[.5rem]"
                                        >
                                            {tag}
                                        </div>
                                    ))
                            }
                        </ul>
                    </dd>
                    {
                        usableProps.pubDate && (
                            <dd
                                id="published"
                                class="text-sm text-foreground-2"
                            >
                                <strong>Published:</strong>{" "}
                                {dateObjToFullDate(usableProps.pubDate)}
                            </dd>
                        )
                    }
                </dl>
            </header>

            <slot />
        </article>
    </div>
</Layout>
